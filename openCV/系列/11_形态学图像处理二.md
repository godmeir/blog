###【OpenCV入门教程之十一】 形态学图像处理（二）：开运算、闭运算、形态学梯度、顶帽、黑帽合辑
上篇文章中，我们重点了解了腐蚀和膨胀这两种最基本的形态学操作，而运用这两个基本操作，我们可以实现更高级的形态学变换。
所以，本文的主角是OpenCV中的morphologyEx函数，它利用基本的膨胀和腐蚀技术，来执行更加高级的形态学变换，如开闭运算、形态学梯度、“顶帽”、“黑帽”等等。

####一、理论与概念讲解——从现象到本质
首先呢，要知道形态学的高级形态，往往都是建立在腐蚀和膨胀这两个基本操作之上的。

1.1 开运算（Opening Operation）
 


开运算（Opening Operation），其实就是先腐蚀后膨胀的过程。其数学表达式如下：




开运算可以用来消除小物体、在纤细点处分离物体、平滑较大物体的边界的同时并不明显改变其面积。

1.2 闭运算(Closing Operation)

先膨胀后腐蚀的过程称为闭运算(Closing Operation)，其数学表达式如下：
 
闭运算能够排除小型黑洞(黑色区域)。

1.3 形态学梯度（MorphologicalGradient）

形态学梯度（Morphological Gradient）为膨胀图与腐蚀图之差，数学表达式如下：

 
对二值图像进行这一操作可以将团块（blob）的边缘突出出来。我们可以用形态学梯度来保留物体的边缘轮廓

1.4 顶帽（Top Hat）

顶帽运算（Top Hat）又常常被译为”礼帽“运算。为原图像与上文刚刚介绍的“开运算“的结果图之差，数学表达式如下：

因为开运算带来的结果是放大了裂缝或者局部低亮度的区域，因此，从原图中减去开运算后的图，得到的效果图突出了比原图轮廓周围的区域更明亮的区域，且这一操作和选择的核的大小相关。
顶帽运算往往用来分离比邻近点亮一些的斑块。当一幅图像具有大幅的背景的时候，而微小物品比较有规律的情况下，可以使用顶帽运算进行背景提取。

1.5 黑帽（Black Hat）


黑帽（Black Hat）运算为”闭运算“的结果图与原图像之差。数学表达式为：


黑帽运算后的效果图突出了比原图轮廓周围的区域更暗的区域，且这一操作和选择的核的大小相关。
所以，黑帽运算用来分离比邻近点暗一些的斑块。

